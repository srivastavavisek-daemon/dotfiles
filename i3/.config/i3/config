# ██╗██████╗░  ░█████╗░░█████╗░███╗░░██╗███████╗██╗░██████╗░
# ╚═╝╚════██╗  ██╔══██╗██╔══██╗████╗░██║██╔════╝██║██╔════╝░
# ██║░█████╔╝  ██║░░╚═╝██║░░██║██╔██╗██║█████╗░░██║██║░░██╗░
# ██║░╚═══██╗  ██║░░██╗██║░░██║██║╚████║██╔══╝░░██║██║░░╚██╗
# ██║██████╔╝  ╚█████╔╝╚█████╔╝██║░╚███║██║░░░░░██║╚██████╔╝
# ╚═╝╚═════╝░  ░╚════╝░░╚════╝░╚═╝░░╚══╝╚═╝░░░░░╚═╝░╚═════╝░

# srivastavavisek

# i3 config file (v4)
# This file has been auto-generated by i3-config-wizard(1).
# It will not be overwritten, so edit it as you like.
# Should you change your keyboard layout some time, delete
# this file and re-run i3-config-wizard(1).
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

# █████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗
# ╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝
# [ CORE ]

set $mod Mod4
set $amod Mod1

set $term alacritty

# fonts and colors
font pango:JetBrains Mono Nerd Font 9

#exec --no-startup-id dex --autostart --environment i3
# .desktop file exists only for autostart purposes in a DEs. 
# It tells the DE “run this on login”. 
# dex reads the .desktop files in standard autostart locations

#exec --no-startup-id xss-lock --transfer-sleep-lock -- i3lock --nofork
exec --no-startup-id xss-lock --transfer-sleep-lock -- $HOME/repos/scripts/lock
#exec --no-startup-id nm-applet

# compositor
#exec_always --no-startup-id picom -b

bindsym $mod+d exec --no-startup-id rofi -show drun
exec --no-startup-id dunst
#exec --no-startup-id xedgewarp -b

exec --no-startup-id thunderbird

#exec --no-startup-id feh --randomize --bg-fill $HOME/Gallery/_wallpapers/*
exec_always --no-startup-id feh --bg-fill $HOME/Gallery/_wallpapers/b-495.jpg
#exec_always --no-startup-id $HOME/repos/scripts/wallpaper2
bindsym $mod+Shift+i exec --no-startup-id $HOME/repos/scripts/wallpaper2

# bindsym $amod+Shift+i exec --no-startup-id $HOME/repos/scripts/wallpaper next
# bindsym $amod+Shift+o exec --no-startup-id $HOME/repos/scripts/wallpaper prev

# █████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗
# ╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝
# [ WORKFLOW: KEY-BINDINGS AND UTILITIES ]

bindsym $mod+Return exec $term
bindsym $mod+e exec thunar
bindsym $amod+8 exec code
bindsym $amod+0 exec obsidian
bindsym $amod+9 exec brave

# reload the configuration file
bindsym $mod+Shift+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# exit i3 (logs you out of your X session)
#bindsym $mod+Shift+q "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -B 'Yes, exit i3' 'i3-msg exit'"

bindsym XF86MonBrightnessUp exec --no-startup-id $HOME/repos/scripts/brightness up
bindsym XF86MonBrightnessDown exec --no-startup-id $HOME/repos/scripts/brightness down

#set $refresh_i3status killall -SIGUSR1 i3status
#bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5% 
#bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5% 
#bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioRaiseVolume exec --no-startup-id $HOME/repos/scripts/volume up
bindsym XF86AudioLowerVolume exec --no-startup-id $HOME/repos/scripts/volume down
bindsym XF86AudioMute exec --no-startup-id $HOME/repos/scripts/volume toggle

# kill focused container
bindsym $mod+q kill

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod
# move tiling windows via drag & drop by left-clicking into the title bar,
# or left-clicking anywhere into the window while holding the floating modifier.
tiling_drag modifier titlebar

# vim-style focus
bindsym $mod+h          focus   left
bindsym $mod+j          focus   down
bindsym $mod+k          focus   up
bindsym $mod+l          focus   right
# change focus between tiling / floating windows
bindsym $amod+space focus mode_toggle

# Scroll 
bindsym $amod+Up        exec    --no-startup-id xdotool click 4
bindsym $amod+Down      exec    --no-startup-id xdotool click 5

# move focused window
bindsym $mod+Shift+h    move    left  20px
bindsym $mod+Shift+j    move    down  20px
bindsym $mod+Shift+k    move    up    20px
bindsym $mod+Shift+l    move    right 20px
# If the focused container is floating → moves the container 20 pixels.
# If the focused container is tiled → tries to move the container in the tree

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# toggle tiling / floating
bindsym $mod+Shift+f floating toggle

# toggle the orientation of the next split container
bindsym $mod+t split toggle
# Toggle layout/tabbed/stacking
bindsym $mod+Shift+t layout toggle all

# focus the parent and child container
bindsym $mod+p focus parent
bindsym $mod+Shift+p focus child

bindsym $mod+bracketleft  workspace prev
bindsym $mod+bracketright workspace next

bindsym --release $mod+b bar mode toggle

# Swapping containers
bindsym $amod+Shift+1   mark swap1; exec --no-startup-id notify-send "Container is marked with: swap1"
bindsym $amod+Shift+2   mark swap2; exec --no-startup-id notify-send "Container is marked with: swap2"
bindsym $amod+1         swap container with mark swap1
bindsym $amod+2         swap container with mark swap2
# unmark everything
bindsym $amod+grave unmark; exec --no-startup-id notify-send "Unmark every swaps"

# Sticky window
bindsym $mod+s sticky toggle; exec --no-startup-id notify-send "Sticky Toggled"

# Scratchpad: secret trapdoor of i3
# Send focused window to scratchpad
bindsym $mod+Shift+grave exec --no-startup-id notify-send "Sent to scratchpad"; mark scratch, move scratchpad
# Show / hide scratchpad window
bindsym $mod+grave scratchpad show; focus
# Repeated presses cycle through them round-robin style.

# clipboard-manager
bindsym $mod+c exec --no-startup-id $HOME/repos/scripts/cliphist add
bindsym $mod+$amod+c exec --no-startup-id $HOME/repos/scripts/cliphist menu

#bindsym --release $mod+y exec --no-startup-id import /tmp/latest-screenshot.png
#bindsym --release $mod+m exec --no-startup-id import -window root /tmp/latest-screenshot.png

# screenshot-tool 
# Print: interactive area-capture (crop) 
# Mod+Print: screen capture (immediate)
bindsym Print exec --no-startup-id flameshot gui 
#bindsym $mod+Print exec --no-startup-id flameshot full 
bindsym $mod+Print exec --no-startup-id $HOME/repos/scripts/screenshot

# █████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗
# ╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝
# [ WORKSPACE ]

# Define names for default workspaces for which we configure key bindings later on.
# We use variables to avoid repeating the names in multiple places.
set $ws1 "1: "
set $ws2 "2:󰅩 "
set $ws3 "3: "
set $ws4 "4: "
set $ws5 "5:W5"
set $ws6 "6:󰎇 "
set $ws7 "7:AUX"
set $ws8 "8: "
set $ws9 "9:󰇥 "
set $ws0 "10:󰎍 "

# switch to workspace
bindsym $mod+1 workspace number $ws1
bindsym $mod+2 workspace number $ws2
bindsym $mod+3 workspace number $ws3
bindsym $mod+4 workspace number $ws4
bindsym $mod+5 workspace number $ws5
bindsym $mod+6 workspace number $ws6
bindsym $mod+7 workspace number $ws7
bindsym $mod+8 workspace number $ws8
bindsym $mod+9 workspace number $ws9
bindsym $mod+0 workspace number $ws0

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number $ws1
bindsym $mod+Shift+2 move container to workspace number $ws2
bindsym $mod+Shift+3 move container to workspace number $ws3
bindsym $mod+Shift+4 move container to workspace number $ws4
bindsym $mod+Shift+5 move container to workspace number $ws5
bindsym $mod+Shift+6 move container to workspace number $ws6
bindsym $mod+Shift+7 move container to workspace number $ws7
bindsym $mod+Shift+8 move container to workspace number $ws8
bindsym $mod+Shift+9 move container to workspace number $ws9
bindsym $mod+Shift+0 move container to workspace number $ws0
#bindsym $mod+Shift+2 move container to workspace number $ws2; workspace $ws2

# class                 border  bground text    indicator child_border
client.focused          #689d6a #689d6a #282828 #282828   #6272A4
client.focused_inactive #1d2021 #1d2021 #928374 #282828   #44475A
client.unfocused        #32302f #32302f #928374 #282828   #282A36
client.urgent           #cc241d #cc241d #ebdbb2 #282828   #FF5555
client.placeholder      #282A36 #282A36 #F8F8F2 #282A36   #282A36

# n-pixel border and no title bar
new_window pixel 1
#title_align center
hide_edge_borders vertical

workspace_auto_back_and_forth yes
force_display_urgency_hint 0 ms
focus_on_window_activation urgent
popup_during_fullscreen smart

for_window [floating] resize set 60ppt 60ppt, move position center

# xprop | grep -E "CLASS|INSTANCE"
# xprop | grep WM_CLASS
# xprop | grep WM_WINDOW_ROLE
for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_type="menu"] floating enable
for_window [window_type="dialog"] floating enable
for_window [instance="^(Download|Update|file_progress)"] floating enable
for_window [window_role="^(About|Preferences|Manager)$"] floating enable
for_window [window_role="GtkFileChooserDialog"] floating enable

# assign this app to the workspace.
#assign [class="Brave-browser"] → $ws8
for_window [class="Brave-browser" urgent="latest"] focus

for_window [class="feh"] floating enable
for_window [con_mark="scratch"] floating enable, border pixel 2
for_window [class="mpv"] floating enable
for_window [class="Thunar"] floating enable, resize set 60ppt 70ppt, move position center

for_window [class="Org\.gnome\.gThumb"] floating enable, resize set 90ppt 90ppt, move position center

# i3bar
#bar {
    # disable clicking on workspace buttons
  #  bindsym button1 nop
    # Take a screenshot by right clicking on the bar
 #   bindsym --release button3 exec --no-startup-id import /tmp/latest-screenshot.png
    # execute custom script when scrolling downwards
#    bindsym button5 exec ~/.i3/scripts/custom_wheel_down
#}
bar {
    status_command i3blocks -c ~/.config/i3/i3blocks
    i3bar_command i3bar --transparency
    position top
#   mode invisible

#   font pango:OpenDyslexic Nerd Font Bold 9
    font pango:JetBrainsMono Nerd Font Bold 8

#   strip_workspace_numbers yes
    strip_workspace_name    yes
#   separator_symbol " "

#   stop switching workspaces every time my finger twitches
    bindsym button1 nop
    bindsym button2 nop
    bindsym button3 nop
    bindsym button4 nop
    bindsym button5 nop

#   tray_output primary
    tray_output none
    tray_padding 4
    height 17

    colors {
        statusline          #1ABC9CFF
        background          #2e3440
#       separator           #AAAAAA
#       separator           #44475A

#       <colorclass>        <border>    <background>    <text>
        focused_workspace   #2e3440     #1ABC9CC0       #00000000
        active_workspace    #2e3440     #2e3440         #F8F8F2
        inactive_workspace  #2e3440     #2e3440         #1ABC9C
        urgent_workspace    #00000000   #FF5555         #F8F8F2
        binding_mode        #00000000   #FF5555         #F8F8F2
    } 
}



# █████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗
# ╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝
# [ MODES ]
# In i3, a mode is a named set of key bindings. When you switch into that mode, 
# the default key bindings are suspended and replaced by the bindings defined 
# in that mode. modes = alternate “layers” of keybindings

# RESIZE MODE (you can also use the mouse for that)
set $resizeMode resize
bindsym $mod+r mode "$resizeMode"
mode "$resizeMode" {
        bindsym o       resize shrink   width   10 px   or 10 ppt
        bindsym 9       resize grow     height  10 px   or 10 ppt
        bindsym 0       resize shrink   height  10 px   or 10 ppt
        bindsym i       resize grow     width   10 px   or 10 ppt

        bindsym Shift+o resize shrink   width   4 px    or 4 ppt
        bindsym Shift+9 resize grow     height  4 px    or 4 ppt
        bindsym Shift+0 resize shrink   height  4 px    or 4 ppt
        bindsym Shift+i resize grow     width   4 px    or 4 ppt

        # back to normal: Enter or Escape or $mod+r
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+r mode "default"
}

# POWER MODE
set $powerMode power
bindsym $mod+Control+l mode "$powerMode"
mode "$powerMode" {
#   bindsym l mode "default", exec --no-startup-id i3lock -c 00000000
    bindsym l mode "default", exec --no-startup-id $HOME/repos/scripts/lock2
      
#   bindsym e mode "default", exec --no-startup-id i3exit logout    
#   bindsym s mode "default", exec --no-startup-id i3exit suspend   
#   bindsym r mode "default", exec --no-startup-id i3exit reboot    
#   bindsym p mode "default", exec --no-startup-id i3exit shutdown  
#   bindsym h mode "default", exec --no-startup-id i3exit hibernate 

    bindsym $mod+l mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# GAPS
set $defaultInnerGaps 0
set $defaultOuterGaps 0
gaps inner $defaultInnerGaps
gaps outer $defaultOuterGaps

set $gapsMode gaps
set $gapsModeOuter outer gaps
set $gapsModeInner inner gaps
bindsym $mod+g mode "$gapsMode"
mode "$gapsMode" {
    bindsym o   mode "$gapsModeOuter"
    bindsym i   mode "$gapsModeInner"

    bindsym 0   mode "default", exec --no-startup-id i3-msg "gaps inner current plus set 0" && i3-msg "$gaps outer current set 0"
    bindsym d   mode "default", exec --no-startup-id i3-msg "gaps inner current set $defaultInnerGaps" && i3-msg "gaps outer current set $defaultOuterGaps"
    
    bindsym z   mode "default", exec --no-startup-id i3-msg "gaps inner current set 10" && i3-msg "gaps outer current set 70"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

mode "$gapsModeInner" {
    bindsym plus    gaps inner current plus 5
    bindsym minus   gaps inner current minus 5

    bindsym 0       mode "default", gaps inner current set 0
    bindsym d       mode "default", gaps inner current set $defaultGapsInner

    bindsym Shift+plus    gaps inner current plus 5
    bindsym Shift+minus   gaps inner current minus 5

    bindsym Shift+0       mode "default", gaps inner all set 0
    bindsym Shift+d       mode "default", gaps inner all set $defaultGapsInner

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

mode "$gapsModeOuter" {
    bindsym plus    gaps outer current plus 5
    bindsym minus   gaps outer current minus 5

    bindsym 0       mode "default", gaps outer current set 0
    bindsym d       mode "default", gaps outer current set $defaultGapsOuter

    bindsym Shift+plus    gaps outer all plus 5
    bindsym Shift+minus   gaps outer all minus 5

    bindsym Shift+0       mode "default", gaps outer all set 0
    bindsym Shift+d       mode "default", gaps outer all set $defaultGapsOuter

    bindsym Return mode "default"
    bindsym Escape mode "default"
}


# █████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗
# ╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝

# exec:
# executes once on startup. prevents multiple instances

# exec_always:
# executes every time i3 reloads, in addition to startup

# --no-startup-id: 
# tells the window manager not to track the startup of the application.

# bindsym $keybind exec --no-startup-id $program
# only shows the window of an already-running $program instance 
# it does not start $program itself.

# When you switch to another binding mode, all bindings from the current mode 
# are released and only the bindings defined in the new mode are valid 
# for as long as you stay in that binding mode
# The only predefined binding mode is default

# you don’t need --no-startup-id for a normal GUI app like Thunar. 
# That option is mainly for background daemons or tray apps 
# that don’t show a window and can confuse i3’s startup notification system.
